var E=Object.defineProperty;var S=(t,e,n)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var u=(t,e,n)=>(S(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();class w{constructor(){u(this,"lat");u(this,"lng");this.lat=0,this.lng=0}getUserCoordinates(){return new Promise((e,n)=>{navigator.geolocation.getCurrentPosition(s=>{this.lat=s.coords.latitude,this.lng=s.coords.longitude,e(!0)},s=>{if(s.code===1){e(null);return}n(console.error(s.message))})})}setCoordinates(e,n){this.lat=e,this.lng=n}}class L{constructor(e){u(this,"restaurants",[]);u(this,"map");this.initMap(e)}initMap(e){this.map=new google.maps.Map(e,{zoom:6,center:{lat:59.3297408,lng:18.0158464}})}retrieveRestaurants(e,n){return new Promise(s=>{const o={location:e,radius:n,type:["restaurant"]};new google.maps.places.PlacesService(this.map).nearbySearch(o,(c,p)=>{p===google.maps.places.PlacesServiceStatus.OK?(this.restaurants=c,s(c)):s(null)})})}setMarker(e){e.setMap(this.map)}setMarkers(e){e.forEach(n=>{n.setMap(this.map)})}}const d=document.querySelector("#app"),q=document.querySelector("#map"),m=document.querySelector("#start-btn"),g=document.querySelector("#display-btn"),f=document.querySelector("#remove-btn"),h=document.querySelector("#roulette-btn"),C=Array.from(document.querySelectorAll('input[name="range-input"]')),l=[],a=new L(q);let y=[],v,M=500,i=null,k;function O(){v=new google.maps.Marker({position:i})}function N(t){const{target:e}=t;e&&(M=Number(e.value))}function P(t,e){t.open(a.map,e)}function b(){l.forEach(t=>{t.setMap(null)}),console.log(l)}function R(t){switch(l.length=0,t.forEach(e=>{if(e.business_status==="OPERATIONAL"&&e.opening_hours&&e.opening_hours.open_now){const s=e.geometry.location.lat(),o=e.geometry.location.lng(),r=new w;r.setCoordinates(s,o);const c=new google.maps.Marker({position:r}),p=new google.maps.InfoWindow({content:`<h2 style="color: black">${e.name}</h2>`});c.addListener("click",()=>P(p,c)),l.push(c)}}),M){case 500:a.map.setZoom(15);break;case 1e3:a.map.setZoom(14);break;case 3e3:a.map.setZoom(12);break;default:a.map.setZoom(12);break}}function x(){console.log("Startar appen"),(async()=>{i=new w,await i.getUserCoordinates(),await a.retrieveRestaurants(i,M)})().then(()=>{console.log("Koordinater h\xE4mtade!"),i&&d?(y=[...a.restaurants],d.innerHTML=`Din position \xE4r ${i.lat} och ${i.lng}`,O(),a.setMarker(v),a.setMarkers(l),a.map.setZoom(15),a.map.setCenter(i),R(y)):d&&(d.innerHTML="Du beh\xF6ver aktivera platstj\xE4nster")}).catch(t=>{console.log("N\xE5got gick fel"),console.error(t)})}function A(){const t=Math.floor(Math.random()*(l.length-1));console.log(t),k=l[t],b(),console.log(k),a.setMarkers([k])}m==null||m.addEventListener("click",x);g==null||g.addEventListener("click",()=>{a.setMarkers(l)});h==null||h.addEventListener("click",A);f==null||f.addEventListener("click",b);C.forEach(t=>{t.addEventListener("click",N)});
